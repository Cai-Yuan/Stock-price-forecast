function   output_results = data_fitting (data)  %输入应该是一行400列

 clc;
 clear;
 close all;
 data =[72,71.8000000000000,72.6000000000000,73.2000000000000,74.8000000000000,75.8000000000000,76.4000000000000,75.2000000000000,75.6000000000000,74.8000000000000,76,76.8000000000000,75.4000000000000,75.8000000000000,75.6000000000000,74.4000000000000,75.2000000000000,74.8000000000000,75,76.2000000000000,73.8000000000000,72.4000000000000,72.6000000000000,73.8000000000000,76,76.6000000000000,79,78.4000000000000,77.6000000000000,79.4000000000000,78.8000000000000,79,79.8000000000000,80,84.8000000000000,85.6000000000000,85.2000000000000,87.2000000000000,87,87.6000000000000,88.8000000000000,92.6000000000000,92.6000000000000,85.4000000000000,89.2000000000000,90.4000000000000,87.6000000000000,86.6000000000000,87.4000000000000,89.8000000000000,89,89.6000000000000,90.6000000000000,99.6000000000000,95.8000000000000,92.4000000000000,91,91.4000000000000,92.6000000000000,101.800000000000,104,102.400000000000,105.200000000000,104,104.600000000000,113.200000000000,124.600000000000,137,137.600000000000,139.400000000000,153.400000000000,143.200000000000,140.600000000000,133.600000000000,126.600000000000,129.400000000000,122,120.800000000000,112.200000000000,114,102.600000000000,104.200000000000,107.200000000000,105.800000000000];
     
         [data_r,data_c]=size(data);
         
         if data_r ~=1 
             error('Invalid argument provided.');  %
         end
         
         output_results=zeros(1,data_c);
         if data_c < 30 %数据量小于30是不分析的      
             return;
         end
         %%
         x=1:data_c;
         
        
         plot(data);

         
         
        coeffis =polyfit(x,data,6);
        output_results=coeffis(1)*x.^6 + coeffis(2)*x.^5 + coeffis(3)*x.^4 +coeffis(4)*x.^3 + coeffis(5)*x.^2 +coeffis(6)*x.^1 +coeffis(7);
 %%        
        
        hold on

        % plot(output_results,'r');
         

         
         
         output3 =smooth(data,14,'lowess');
         
         
         for i=data_c-6:data_c
             
             if i<data_c-2 %(398)
                 output3(i)=sum(data(i-2:i+2) )/(5);
             else
                 output3(i)=sum(data(i-2:data_c))/(data_c-i+3);
             end
             
         end
         
         
             
             
             
             
             
             
         hold on
         plot(output3)
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
end