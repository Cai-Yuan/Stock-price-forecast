function   [output_results,zero_points] = plot_day20_and_day30(data)  %输入应该是一行400列
%clear;

     %data=[14.6800000000000,14.1900000000000,13.4600000000000,13.4500000000000,13.5600000000000,13.4900000000000,13.2900000000000,12.5900000000000,12.8000000000000,13.0500000000000,13.1700000000000,13.7200000000000,13.7100000000000,13.7600000000000,13.5600000000000,13.8500000000000,13.8800000000000,14.2800000000000,14.0500000000000,14.0500000000000,13.9800000000000,14.0800000000000,13.5700000000000,13.4500000000000,13.5800000000000,13.7200000000000,13.4700000000000,13.4500000000000,13.8400000000000,13.9000000000000,13.9800000000000,14.0100000000000,14.2300000000000,14.1200000000000,14.0500000000000,13.9400000000000,13.8900000000000,14.8900000000000,14.7800000000000,13.3800000000000,13.4700000000000,13.4900000000000,13.7200000000000,15.0900000000000,15.4300000000000,14.9900000000000,15.2100000000000,14.9300000000000,14.7000000000000,14.7800000000000,14.7100000000000,14.1000000000000,14.1500000000000,14.2900000000000,14.4400000000000,14.2200000000000,14.9900000000000,14.8000000000000,14.7600000000000,14.8900000000000,14.7400000000000,14.7000000000000,15.1200000000000,15.0900000000000,15.2700000000000,15.0700000000000,14.9900000000000,14.8300000000000,15,15.0800000000000,15.2400000000000,15.0600000000000,14.9800000000000,15.2100000000000,15.4800000000000,15.9200000000000,15.7200000000000,15.3300000000000,15.3100000000000,15.2200000000000,15.0800000000000,14.9500000000000,15,14.7100000000000,14.8000000000000,14.8300000000000,14.9300000000000,14.6100000000000,14.6700000000000,14.3900000000000,14.1600000000000,14.0500000000000,13.8500000000000,14.0700000000000,14.3800000000000,14.5700000000000,14.6300000000000,14.5300000000000,14.9400000000000,14.2800000000000,14.8300000000000,14.4200000000000,14.3900000000000,14.5500000000000,14.6900000000000,14.7700000000000,14.9000000000000,14.8100000000000,14.8000000000000,14.3900000000000,14.6600000000000,14.7000000000000,14.7800000000000,14.6600000000000,14.4800000000000,14.4300000000000,14.4300000000000,14.5400000000000,14.3700000000000,14.0600000000000,13.8700000000000,13.9500000000000,13.6900000000000,12.9800000000000,13.0700000000000,12.7400000000000,12.6900000000000,13.1000000000000,12.8300000000000,12.6500000000000,12.8000000000000,12.6700000000000,12.7300000000000,12.8000000000000,12.7000000000000,12.4200000000000,12.4600000000000,12.5800000000000,12.8000000000000,12.9700000000000,12.6800000000000,12.7800000000000,12.9500000000000,13.2900000000000,12.9000000000000,12.8200000000000,12.6900000000000,12.5300000000000,12.6100000000000,12.4000000000000,12.4500000000000,12.4900000000000,12.8200000000000,12.6600000000000,12.6700000000000,13.5400000000000,13.1600000000000,13.3400000000000,13.0800000000000,13.0200000000000,12.5400000000000,12.5800000000000,12.5800000000000,12.1900000000000,11.8300000000000,11.6300000000000,11.6700000000000,11.6700000000000,11.8800000000000,11.7700000000000,11.7600000000000,11.7400000000000,11.7000000000000,11.5800000000000,11.5400000000000,11.5100000000000,10.8900000000000,10.0300000000000,9.90000000000000,9.22000000000000,9.50000000000000,9.61000000000000,9.56000000000000,9.84000000000000,10.0200000000000,10.2400000000000,10.2400000000000,10.2900000000000,10.6200000000000,10.6600000000000,10.7900000000000,10.7900000000000,10.8100000000000,10.8400000000000,11.1000000000000,11.3100000000000,11.4500000000000,11.5300000000000,11.6200000000000,11.5500000000000,11.3100000000000,11.6400000000000,11.5900000000000,11.5000000000000,11.8200000000000,12.1600000000000,11.9500000000000,11.8900000000000,11.8400000000000,12.5200000000000,12.4700000000000,12.3200000000000,12.1600000000000,12.4000000000000,12.1400000000000,11.9200000000000,11.8300000000000,11.8400000000000,11.9100000000000,13.1000000000000,12.5500000000000,12.5300000000000,12.7000000000000,12.6800000000000,12.5000000000000,12.7300000000000,12.7700000000000,12.9000000000000,12.7500000000000,12.4900000000000,12.1900000000000,12.8000000000000,12.8800000000000,12.9100000000000,13,13,13.0700000000000,13.3900000000000,13.4100000000000,13.1200000000000,13.1700000000000,13.1700000000000,13,13.0200000000000,13.0500000000000,12.9900000000000,12.8200000000000,12.9200000000000,12.8700000000000,12.4000000000000,12.0600000000000,11.8500000000000,11.9500000000000,11.7400000000000,11.8000000000000,11.9600000000000,11.0100000000000,10.4000000000000,10.0600000000000,9.34000000000000,9.37000000000000,8.85000000000000,9.34000000000000,8.62000000000000,7.90000000000000,8.09000000000000,8.44000000000000,8.89000000000000,9.13000000000000,8.93000000000000,9.82000000000000,10.7200000000000,10.4400000000000,10.3300000000000,10.1500000000000,10,9.36000000000000,9.53000000000000,9.75000000000000,9.80000000000000,9.53000000000000,10.0200000000000,10.0800000000000,10.2000000000000,10.1300000000000,10.1000000000000,10.1300000000000,10.0900000000000,10.1300000000000,10.3500000000000,10.3800000000000,10.4200000000000,10.4200000000000,10.0700000000000,10.2500000000000,10.2000000000000,10.5400000000000,10.9300000000000,10.1900000000000,10.1000000000000,10.1700000000000,10.1900000000000,10.1000000000000,10.1900000000000,10.4800000000000,10.1800000000000,10.8100000000000,10.6000000000000,10.3400000000000,10.2300000000000,10,9.93000000000000,9.83000000000000,10.1300000000000,10.0800000000000,9.97000000000000,9.91000000000000,9.68000000000000,9.66000000000000,9.87000000000000,9.80000000000000,10.0200000000000,9.99000000000000,9.59000000000000,9.40000000000000,9.35000000000000,9.46000000000000,9.31000000000000,9.08000000000000,9.17000000000000,9.24000000000000,9.30000000000000,9.35000000000000,9.39000000000000,9.25000000000000,9.22000000000000,9.43000000000000,9.05000000000000,9.11000000000000,9.12000000000000,8.22000000000000,8.25000000000000,7.82000000000000,8.60000000000000,9.46000000000000,8.64000000000000,9.50000000000000,10.4500000000000,11.0600000000000,10.4700000000000,10.5000000000000,10.5800000000000,10.1300000000000,10.0500000000000,10.0500000000000,10.7900000000000,10.5200000000000,10.5400000000000,10.3300000000000,10.7300000000000,10.4100000000000,10.1500000000000,10.5200000000000,10.7300000000000,10.6100000000000,10.7600000000000,10.9600000000000,11.3000000000000,11.2400000000000,11.4500000000000,11.0100000000000,10.4200000000000,10.4500000000000,10.6500000000000,10.5800000000000,11.1800000000000,10.7000000000000,10.9900000000000,10.9000000000000,10.6600000000000,10.6900000000000,10.4400000000000,10.4300000000000,10.4700000000000,10.4800000000000,10.4100000000000,10.1000000000000,9.91000000000000,10.1000000000000,9.85000000000000,9.95000000000000,10.0400000000000,9.92000000000000,9.93000000000000,9.99000000000000,9.48000000000000,9.62000000000000,9.70000000000000,10.3800000000000,10.3100000000000] ;
 %    data=[5.64000000000000,5.98000000000000,5.96000000000000,5.93000000000000,5.93000000000000,5.91000000000000,5.93000000000000,5.88000000000000,5.77000000000000,5.79000000000000,5.85000000000000,5.82000000000000,5.88000000000000,5.86000000000000,5.85000000000000,5.93000000000000,5.94000000000000,6,5.95000000000000,6.04000000000000,6.08000000000000,5.96000000000000,5.87000000000000,5.90000000000000,6.05000000000000,5.88000000000000,5.92000000000000,6.07000000000000,6.04000000000000,6.08000000000000,6.08000000000000,6.02000000000000,6,6.05000000000000,5.96000000000000,6,6.16000000000000,6.07000000000000,6.03000000000000,6.03000000000000,6,5.96000000000000,5.95000000000000,5.90000000000000,5.78000000000000,5.83000000000000,5.81000000000000,5.85000000000000,5.88000000000000,5.96000000000000,6.01000000000000,5.93000000000000,5.89000000000000,5.84000000000000,5.89000000000000,5.93000000000000,5.97000000000000,5.92000000000000,5.90000000000000,5.94000000000000,5.90000000000000,5.94000000000000,5.96000000000000,5.91000000000000,5.98000000000000,6.15000000000000,6.35000000000000,6.24000000000000,6.26000000000000,6.24000000000000,6.60000000000000,6.47000000000000,6.56000000000000,6.56000000000000,6.46000000000000,6.24000000000000,6.31000000000000,6.38000000000000,6.62000000000000,6.91000000000000,7.23000000000000,7.07000000000000,6.87000000000000,6.92000000000000,6.88000000000000,6.67000000000000,6.71000000000000,6.58000000000000,6.47000000000000,6.63000000000000,6.54000000000000,6.46000000000000,6.49000000000000,6.52000000000000,6.47000000000000,6.21000000000000,6.26000000000000,6.35000000000000,6.24000000000000,6.19000000000000,6.27000000000000,6.29000000000000,6.37000000000000,6.40000000000000,6.33000000000000,6.33000000000000,6.17000000000000,6.19000000000000,6.12000000000000,5.83000000000000,5.86000000000000,5.87000000000000,5.84000000000000,5.68000000000000,5.68000000000000,5.65000000000000,5.70000000000000,5.82000000000000,5.78000000000000,5.96000000000000,5.84000000000000,5.73000000000000,5.77000000000000,5.75000000000000,5.80000000000000,5.88000000000000,5.77000000000000,5.77000000000000,5.84000000000000,5.78000000000000,5.78000000000000,5.79000000000000,5.69000000000000,5.68000000000000,5.65000000000000,5.56000000000000,5.63000000000000,5.91000000000000,5.85000000000000,5.85000000000000,5.91000000000000,5.91000000000000,5.85000000000000,5.85000000000000,5.92000000000000,5.93000000000000,5.82000000000000,5.79000000000000,5.88000000000000,5.71000000000000,5.75000000000000,5.72000000000000,5.72000000000000,5.69000000000000,5.74000000000000,5.72000000000000,5.74000000000000,5.71000000000000,5.71000000000000,5.63000000000000,5.63000000000000,5.57000000000000,5.33000000000000,5.20000000000000,5.17000000000000,4.93000000000000,5.01000000000000,5.08000000000000,4.91000000000000,5.07000000000000,5.06000000000000,5.07000000000000,5.14000000000000,5.13000000000000,5.19000000000000,5.19000000000000,5.17000000000000,5.18000000000000,5.21000000000000,5.18000000000000,5.19000000000000,5.15000000000000,5.15000000000000,5.19000000000000,5.24000000000000,5.30000000000000,5.19000000000000,5.27000000000000,5.34000000000000,5.30000000000000,5.26000000000000,5.24000000000000,5.17000000000000,4.85000000000000,4.87000000000000,4.92000000000000,4.87000000000000,4.90000000000000,4.92000000000000,4.93000000000000,4.89000000000000,4.92000000000000,4.92000000000000,4.96000000000000,4.94000000000000,4.88000000000000,4.85000000000000,4.68000000000000,4.62000000000000,4.62000000000000,4.62000000000000,4.53000000000000,4.46000000000000,4.53000000000000,4.52000000000000,4.36000000000000,4.33000000000000,4.39000000000000,4.48000000000000,4.49000000000000,4.57000000000000,4.57000000000000,4.58000000000000,4.59000000000000,4.69000000000000,4.63000000000000,4.65000000000000,4.58000000000000,4.55000000000000,4.60000000000000,4.67000000000000,4.69000000000000,4.69000000000000,4.65000000000000,4.54000000000000,4.45000000000000,4.45000000000000,4.33000000000000,4.36000000000000,4.34000000000000,4.34000000000000,4.38000000000000,4.42000000000000,4.36000000000000,4.29000000000000,4.29000000000000,4.30000000000000,4.49000000000000,4.40000000000000,4.37000000000000,3.96000000000000,3.99000000000000,3.86000000000000,3.89000000000000,3.87000000000000,3.95000000000000,3.98000000000000,3.93000000000000,4.09000000000000,3.99000000000000,4,3.93000000000000,3.82000000000000,3.87000000000000,3.95000000000000,3.95000000000000,3.88000000000000,3.94000000000000,3.96000000000000,3.87000000000000,3.86000000000000,3.97000000000000,3.90000000000000,3.91000000000000,3.98000000000000,4.09000000000000,4.11000000000000,4.12000000000000,4.11000000000000,4.08000000000000,4.08000000000000,4.03000000000000,3.88000000000000,3.86000000000000,3.81000000000000,3.89000000000000,3.86000000000000,3.91000000000000,3.91000000000000,3.89000000000000,3.90000000000000,3.84000000000000,3.82000000000000,3.80000000000000,3.84000000000000,3.86000000000000,3.83000000000000,3.85000000000000,3.85000000000000,3.89000000000000,3.88000000000000,3.89000000000000,3.90000000000000,3.87000000000000,3.85000000000000,3.91000000000000,3.88000000000000,3.85000000000000,3.86000000000000,3.81000000000000,3.80000000000000,3.80000000000000,3.83000000000000,3.88000000000000,3.81000000000000,3.84000000000000,3.87000000000000,3.86000000000000,3.98000000000000,3.95000000000000,3.95000000000000,3.91000000000000,3.96000000000000,3.84000000000000,3.82000000000000,3.81000000000000,3.43000000000000,3.32000000000000,3.27000000000000,3.25000000000000,3.28000000000000,3.17000000000000,3.21000000000000,3.34000000000000,3.31000000000000,3.31000000000000,3.54000000000000,3.49000000000000,3.41000000000000,3.51000000000000,3.49000000000000,3.49000000000000,3.57000000000000,3.57000000000000,3.79000000000000,3.70000000000000,3.69000000000000,3.63000000000000,3.82000000000000,3.88000000000000,3.92000000000000,3.91000000000000,3.90000000000000,4.01000000000000,3.93000000000000,3.93000000000000,3.99000000000000,3.80000000000000,3.81000000000000,3.89000000000000,3.89000000000000,3.83000000000000,3.83000000000000,3.95000000000000,3.97000000000000,3.88000000000000,3.83000000000000,3.83000000000000,3.74000000000000,3.76000000000000,3.80000000000000,3.88000000000000,3.82000000000000,3.74000000000000,3.71000000000000,3.69000000000000,3.67000000000000,3.61000000000000,3.70000000000000,3.62000000000000,3.68000000000000,3.57000000000000,3.60000000000000,3.59000000000000,3.63000000000000,3.66000000000000,3.74000000000000,3.79000000000000,3.82000000000000,3.76000000000000,3.78000000000000,3.74000000000000,3.80000000000000,3.84000000000000,3.77000000000000,3.79000000000000,3.78000000000000,3.72000000000000,3.76000000000000,3.74000000000000];
    
%        if ~isempty(varargin)
%            data=varargin
%        else
%            name='sz002822';
%            historial_data = get_historal_data_function(name); %新浪的数据
%            historial_data=cell2mat( historial_data(2:end,2:end));
%            data=historial_data(4,1:end);
%        end
    
    
       [data_r,data_c]=size(data);
         
         if data_r ~=1 && ~isempty(find(data==0,1) )
             error('Invalid argument provided. The length of the data shoulb be 4 and nonzero');  %股价里面不能有0值
         end
         
         if data_c < 200
             output_results=0; %数据量小于200是不分析的,默认的数据是400个
             return;
         end
         
        data_day20=zeros(data_r,data_c); %创建20天平均值    
        data_day32=zeros(data_r,data_c); %创建34天平均值 

%% 生成day20和生成day32


              for i = 1:data_c
                    %% 生成day20
                     if i<11
                         data_day20(i) = sum(data(1:i+10))/(i+10);
                     elseif i>data_c-11  %389
                         data_day20(i) = sum(data(i-10:data_c))/(data_c-i+11);
                     else
                         data_day20(i) = sum(data(i-10:i+10))/21;
                     end
                     
                     
                    %% %% 生成day32
                     if i<32
                         data_day32(i) = sum( data(1:i) )/i;
                     else %34
                         data_day32(i) = sum( data(i-31:i) )/32;   
                     end    
                     
                     
              end
%%
 
             output_results=data_day20-data_day32;

for j=1:data_c   %将曲线再次平滑，左右3个点再次平均一次
           
           if j<4
               output_results(j)=sum(output_results(1:j+4))/(j+3);
           elseif j>data_c-4 %396
               output_results(j)=sum(output_results(j-3:data_c))/(data_c-j+4);
           else
               output_results(j)=sum(output_results(j-2:j+4))/7;
           end
           
end



    numbers_of_0=1;
     
      for j=1:data_c-1   %
          if output_results(j)*output_results(j+1) <0
              zero_points( numbers_of_0 )=j;
              numbers_of_0= numbers_of_0+1;
          end
      end
      zero_points=[1,zero_points,data_c];
%     new_zero_points=[];
%       
%       for i= 1:length(zero_points)-1
%           
%           
%         if  (zero_points(i+1)-zero_points(i)) < 20
%              new_zero_points=[new_zero_points,i]; 
%         end
%         
%       end
%           
%           
%           new_zero_points=unique(new_zero_points);
%           
%           zero_points(new_zero_points)=[];
          
          
          
      
      
      
      
%% 下面是画图
%if sum( output_results(end-6:end) )  sum( output_results(end-6:end) ) 

figure
 %subplot(1,2,1)
plot(data)
hold on
plot(data_day32)
hold on
plot(data_day20)
 %subplot(1,2,2)
plot(output_results)
hold on
plot(zeros(data_r,data_c))
hold on
for i=1:length(zero_points)%画出零点
      plot( linspace(zero_points(i),zero_points(i),50) ,linspace(0,data(zero_points(i)),50)  )
end


end
























