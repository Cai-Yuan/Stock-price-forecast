function   output_results = cci_caiculation(data)  %输入应该是一行400列

% data=[1.59	1.58	1.59	1.6	1.62	1.62	1.64	1.63	1.64	1.68	1.66	1.66	1.68	1.74	1.7	1.68	1.65	1.65	1.65	1.65	1.64	1.64	1.63	1.64	1.67	1.68	1.7	1.71	1.69	1.71	1.72	1.73	1.73	1.72	1.81	1.98	1.94	1.94	1.91	1.96	1.93	2.11	2.15	2.07	2.02	2.06	2.02	2.01	1.98	2.03	2.03	2	2.01	2	1.97	1.96	1.9	1.9	1.92	1.99	1.98	1.97	1.99	2.05	2.03	1.99	1.97	1.94	1.96	1.96	1.96	1.95	1.97	1.97	1.93	1.93	1.92	1.84	1.8	1.79	1.76	1.69	1.68;
%       1.57	1.56	1.56	1.56	1.59	1.6	1.61	1.61	1.61	1.63	1.63	1.64	1.64	1.66	1.66	1.63	1.63	1.62	1.63	1.62	1.59	1.61	1.61	1.61	1.64	1.66	1.66	1.68	1.66	1.66	1.68	1.69	1.69	1.68	1.72	1.78	1.86	1.87	1.87	1.91	1.89	1.91	2.03	1.95	1.96	1.99	1.96	1.93	1.94	1.96	1.98	1.96	1.98	1.97	1.93	1.87	1.87	1.87	1.83	1.91	1.94	1.93	1.96	1.97	1.98	1.95	1.94	1.91	1.92	1.9	1.94	1.93	1.92	1.92	1.9	1.9	1.86	1.78	1.75	1.75	1.63	1.65	1.63;
%       1.57	1.57	1.57	1.6	1.61	1.61	1.62	1.62	1.63	1.65	1.65	1.65	1.67	1.7	1.68	1.64	1.64	1.64	1.63	1.62	1.63	1.62	1.62	1.63	1.67	1.68	1.7	1.69	1.66	1.71	1.7	1.71	1.7	1.72	1.81	1.9	1.89	1.9	1.91	1.93	1.92	2.1	2.13	1.96	2.02	2.02	1.97	1.95	1.95	2.02	1.99	1.99	1.99	1.98	1.94	1.88	1.9	1.88	1.92	1.97	1.95	1.97	1.98	2.04	1.99	1.97	1.94	1.93	1.92	1.96	1.95	1.93	1.96	1.93	1.91	1.92	1.86	1.8	1.76	1.78	1.66	1.67	1.67];

        [data_r,data_c]=size(data);
         
         if data_r ~=3 
             error('Invalid argument provided.');  
         end
         
         output_results=zeros(1,data_c);
         
         if data_c < 30  %数据量小于30是不分析的
             return;
         end
%%
%     第一种计算过程如下：
% 　　CCI（N日）=（TP－MA）÷MD÷0.015
% 　　%其中，TP=（最高价+最低价+收盘价）÷3
% 　　%MA=近N日收盘价的累计之和÷N
% 　　MD=近N日（MA－收盘价）的绝对值累计之和÷N
% 　　0.015为计算系数，N为计算周期
  

  
  for i=14:data_c
      
      TP=sum( data(1:3,i) )/3;
      MA=sum( data(3,i-13:i))/14; 
      MD=sum(  abs( MA- data(3,i-13:i)  )  )/14;
      
      
      output_results(i)=(TP-MA)/(MD*0.015);
      
  end
  
 % plot(output_results)
   
         
         
end