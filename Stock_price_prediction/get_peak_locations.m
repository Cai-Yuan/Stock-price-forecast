function   output_results = get_peak_locatinos(data)  %输入应该是一行400列
% clc   找到不含端点的各个分段点
%   clear;
  % close all;
% 
%  %   data=[14.6800000000000,14.1900000000000,13.4600000000000,13.4500000000000,13.5600000000000,13.4900000000000,13.2900000000000,12.5900000000000,12.8000000000000,13.0500000000000,13.1700000000000,13.7200000000000,13.7100000000000,13.7600000000000,13.5600000000000,13.8500000000000,13.8800000000000,14.2800000000000,14.0500000000000,14.0500000000000,13.9800000000000,14.0800000000000,13.5700000000000,13.4500000000000,13.5800000000000,13.7200000000000,13.4700000000000,13.4500000000000,13.8400000000000,13.9000000000000,13.9800000000000,14.0100000000000,14.2300000000000,14.1200000000000,14.0500000000000,13.9400000000000,13.8900000000000,14.8900000000000,14.7800000000000,13.3800000000000,13.4700000000000,13.4900000000000,13.7200000000000,15.0900000000000,15.4300000000000,14.9900000000000,15.2100000000000,14.9300000000000,14.7000000000000,14.7800000000000,14.7100000000000,14.1000000000000,14.1500000000000,14.2900000000000,14.4400000000000,14.2200000000000,14.9900000000000,14.8000000000000,14.7600000000000,14.8900000000000,14.7400000000000,14.7000000000000,15.1200000000000,15.0900000000000,15.2700000000000,15.0700000000000,14.9900000000000,14.8300000000000,15,15.0800000000000,15.2400000000000,15.0600000000000,14.9800000000000,15.2100000000000,15.4800000000000,15.9200000000000,15.7200000000000,15.3300000000000,15.3100000000000,15.2200000000000,15.0800000000000,14.9500000000000,15,14.7100000000000,14.8000000000000,14.8300000000000,14.9300000000000,14.6100000000000,14.6700000000000,14.3900000000000,14.1600000000000,14.0500000000000,13.8500000000000,14.0700000000000,14.3800000000000,14.5700000000000,14.6300000000000,14.5300000000000,14.9400000000000,14.2800000000000,14.8300000000000,14.4200000000000,14.3900000000000,14.5500000000000,14.6900000000000,14.7700000000000,14.9000000000000,14.8100000000000,14.8000000000000,14.3900000000000,14.6600000000000,14.7000000000000,14.7800000000000,14.6600000000000,14.4800000000000,14.4300000000000,14.4300000000000,14.5400000000000,14.3700000000000,14.0600000000000,13.8700000000000,13.9500000000000,13.6900000000000,12.9800000000000,13.0700000000000,12.7400000000000,12.6900000000000,13.1000000000000,12.8300000000000,12.6500000000000,12.8000000000000,12.6700000000000,12.7300000000000,12.8000000000000,12.7000000000000,12.4200000000000,12.4600000000000,12.5800000000000,12.8000000000000,12.9700000000000,12.6800000000000,12.7800000000000,12.9500000000000,13.2900000000000,12.9000000000000,12.8200000000000,12.6900000000000,12.5300000000000,12.6100000000000,12.4000000000000,12.4500000000000,12.4900000000000,12.8200000000000,12.6600000000000,12.6700000000000,13.5400000000000,13.1600000000000,13.3400000000000,13.0800000000000,13.0200000000000,12.5400000000000,12.5800000000000,12.5800000000000,12.1900000000000,11.8300000000000,11.6300000000000,11.6700000000000,11.6700000000000,11.8800000000000,11.7700000000000,11.7600000000000,11.7400000000000,11.7000000000000,11.5800000000000,11.5400000000000,11.5100000000000,10.8900000000000,10.0300000000000,9.90000000000000,9.22000000000000,9.50000000000000,9.61000000000000,9.56000000000000,9.84000000000000,10.0200000000000,10.2400000000000,10.2400000000000,10.2900000000000,10.6200000000000,10.6600000000000,10.7900000000000,10.7900000000000,10.8100000000000,10.8400000000000,11.1000000000000,11.3100000000000,11.4500000000000,11.5300000000000,11.6200000000000,11.5500000000000,11.3100000000000,11.6400000000000,11.5900000000000,11.5000000000000,11.8200000000000,12.1600000000000,11.9500000000000,11.8900000000000,11.8400000000000,12.5200000000000,12.4700000000000,12.3200000000000,12.1600000000000,12.4000000000000,12.1400000000000,11.9200000000000,11.8300000000000,11.8400000000000,11.9100000000000,13.1000000000000,12.5500000000000,12.5300000000000,12.7000000000000,12.6800000000000,12.5000000000000,12.7300000000000,12.7700000000000,12.9000000000000,12.7500000000000,12.4900000000000,12.1900000000000,12.8000000000000,12.8800000000000,12.9100000000000,13,13,13.0700000000000,13.3900000000000,13.4100000000000,13.1200000000000,13.1700000000000,13.1700000000000,13,13.0200000000000,13.0500000000000,12.9900000000000,12.8200000000000,12.9200000000000,12.8700000000000,12.4000000000000,12.0600000000000,11.8500000000000,11.9500000000000,11.7400000000000,11.8000000000000,11.9600000000000,11.0100000000000,10.4000000000000,10.0600000000000,9.34000000000000,9.37000000000000,8.85000000000000,9.34000000000000,8.62000000000000,7.90000000000000,8.09000000000000,8.44000000000000,8.89000000000000,9.13000000000000,8.93000000000000,9.82000000000000,10.7200000000000,10.4400000000000,10.3300000000000,10.1500000000000,10,9.36000000000000,9.53000000000000,9.75000000000000,9.80000000000000,9.53000000000000,10.0200000000000,10.0800000000000,10.2000000000000,10.1300000000000,10.1000000000000,10.1300000000000,10.0900000000000,10.1300000000000,10.3500000000000,10.3800000000000,10.4200000000000,10.4200000000000,10.0700000000000,10.2500000000000,10.2000000000000,10.5400000000000,10.9300000000000,10.1900000000000,10.1000000000000,10.1700000000000,10.1900000000000,10.1000000000000,10.1900000000000,10.4800000000000,10.1800000000000,10.8100000000000,10.6000000000000,10.3400000000000,10.2300000000000,10,9.93000000000000,9.83000000000000,10.1300000000000,10.0800000000000,9.97000000000000,9.91000000000000,9.68000000000000,9.66000000000000,9.87000000000000,9.80000000000000,10.0200000000000,9.99000000000000,9.59000000000000,9.40000000000000,9.35000000000000,9.46000000000000,9.31000000000000,9.08000000000000,9.17000000000000,9.24000000000000,9.30000000000000,9.35000000000000,9.39000000000000,9.25000000000000,9.22000000000000,9.43000000000000,9.05000000000000,9.11000000000000,9.12000000000000,8.22000000000000,8.25000000000000,7.82000000000000,8.60000000000000,9.46000000000000,8.64000000000000,9.50000000000000,10.4500000000000,11.0600000000000,10.4700000000000,10.5000000000000,10.5800000000000,10.1300000000000,10.0500000000000,10.0500000000000,10.7900000000000,10.5200000000000,10.5400000000000,10.3300000000000,10.7300000000000,10.4100000000000,10.1500000000000,10.5200000000000,10.7300000000000,10.6100000000000,10.7600000000000,10.9600000000000,11.3000000000000,11.2400000000000,11.4500000000000,11.0100000000000,10.4200000000000,10.4500000000000,10.6500000000000,10.5800000000000,11.1800000000000,10.7000000000000,10.9900000000000,10.9000000000000,10.6600000000000,10.6900000000000,10.4400000000000,10.4300000000000,10.4700000000000,10.4800000000000,10.4100000000000,10.1000000000000,9.91000000000000,10.1000000000000,9.85000000000000,9.95000000000000,10.0400000000000,9.92000000000000,9.93000000000000,9.99000000000000,9.48000000000000,9.62000000000000,9.70000000000000,10.3800000000000,10.3100000000000] ;
%  %   data=[-0.318181818181818,-0.320833333333333,-0.366153846153848,-0.357499999999998,-0.309333333333335,-0.267083333333336,-0.233865546218489,-0.201388888888893,-0.185906432748542,-0.192500000000003,-0.213722943722946,-0.284404761904764,-0.342893772893770,-0.330952380952386,-0.317238095238096,-0.260773809523808,-0.179943977591037,-0.0470634920634900,0.0922556390977469,0.220119047619047,0.324761904761903,0.420995670995673,0.508799171842654,0.515476190476189,0.509276190476189,0.491721611721610,0.495396825396826,0.425000000000003,0.382249589490970,0.358285714285717,0.332119815668204,0.314389880952382,0.296279761904763,0.324568452380952,0.377336309523809,0.393348214285716,0.435223214285713,0.456473214285712,0.331919642857143,0.181041666666667,0.0265327380952414,-0.170788690476190,-0.346800595238094,-0.500565476190474,-0.590937499999996,-0.672068452380945,-0.779062499999998,-0.945059523809517,-1.00964285714285,-1.04714285714285,-1.10711309523809,-1.12903273809524,-1.17988095238095,-1.24794642857143,-1.31055059523810,-1.37148809523810,-1.42811011904762,-1.49132440476191,-1.55183035714287,-1.55904761904763,-1.50574404761905,-1.41125000000001,-1.27361607142858,-1.13510416666667,-1.03276785714287,-0.976041666666671,-0.904211309523820,-0.837172619047621,-0.718050595238097,-0.606696428571429,-0.503273809523805,-0.407202380952377,-0.325744047619040,-0.264449404761898,-0.190089285714279,-0.119300595238087,-0.0489136904761836,0.0711904761904805,0.201294642857143,0.358050595238094,0.515416666666663,0.613764880952381,0.668407738095244,0.725282738095242,0.777559523809526,0.843690476190478,0.918214285714281,0.985252976190470,1.06406249999999,1.09025297619047,1.13162202380952,1.16495535714285,1.18190476190476,1.19352678571428,1.23648809523809,1.27974702380952,1.31956845238095,1.32447916666667,1.35891369047619,1.42074404761905,1.44581845238096,1.46209821428571,1.53665178571429,1.64129464285715,1.73446428571429,1.84544642857144,1.94096726190477,2.03059523809525,2.05430059523810,2.06247023809524,2.07828869047619,2.05858630952381,2.03991071428571,2.06380952380953,2.08995535714286,2.08410714285715,2.08087797619048,2.06544642857143,2.08068452380952,2.03872023809524,1.96752976190476,1.90642857142857,1.81962797619048,1.68962797619048,1.58019345238095,1.46891369047619,1.34049107142857,1.24616071428571,1.14895833333333,1.08482142857143,1.02019345238095,0.942827380952377,0.887291666666663,0.823303571428570,0.698124999999996,0.574642857142855,0.469092261904761,0.348407738095236,0.244211309523811,0.122485119047621,0.0590029761904791,0.0363690476190506,0.0305357142857172,0.0729910714285715,0.135639880952382,0.170892857142858,0.245059523809523,0.331994047619048,0.383229166666666,0.425773809523808,0.467529761904761,0.502321428571424,0.572901785714283,0.686666666666664,0.826919642857140,1.00230654761904,1.14569940476190,1.31876488095238,1.47604166666667,1.63535714285714,1.79922619047619,1.93482142857143,2.03544642857143,2.10056547619048,2.11052083333333,2.12593750000000,2.13995535714286,2.08660714285714,2.04297619047619,2.00760416666667,1.97819940476191,1.94773809523810,1.90934523809524,1.85830357142858,1.75438988095238,1.60464285714286,1.43977678571429,1.27525297619048,1.08986607142858,0.935699404761907,0.765863095238096,0.602053571428574,0.407485119047621,0.163467261904760,-0.128735119047620,-0.345758928571430,-0.544940476190480,-0.756577380952384,-0.904360119047622,-1.08056547619048,-1.23145833333333,-1.37467261904762,-1.47452380952381,-1.53355654761905,-1.53659226190476,-1.58702380952381,-1.62130952380952,-1.61299107142857,-1.59566964285714,-1.54870535714286,-1.49470238095238,-1.43821428571428,-1.42153273809524,-1.33331845238095,-1.18369047619048,-0.960133928571430,-0.798452380952382,-0.642931547619051,-0.494627976190481,-0.377410714285718,-0.264613095238099,-0.163645833333339,-0.0991666666666706,-0.0651934523809548,-0.0749851190476214,-0.0831696428571469,-0.0127827380952397,0.0334672619047591,0.0663988095238111,0.0623958333333299,0.0720238095238077,0.0248809523809506,-0.0167261904761915,-0.0205505952380953,-0.0345089285714284,-0.0965029761904770,-0.180014880952379,-0.198154761904762,-0.227946428571428,-0.244389880952379,-0.246770833333331,-0.224300595238093,-0.209642857142857,-0.161562500000001,-0.124345238095238,-0.0547172619047611,0.0517410714285713,0.107470238095235,0.163467261904760,0.215431547619046,0.282574404761906,0.384330357142856,0.576458333333331,0.766502976190473,0.940327380952379,1.08752976190476,1.21142857142857,1.29537202380952,1.35633928571428,1.42958333333333,1.45700892857143,1.48028273809524,1.43894345238095,1.41755952380952,1.40971726190476,1.40354166666667,1.36125000000000,1.28578869047619,1.22269345238095,1.13870535714286,1.06132440476190,0.987351190476190,0.914791666666668,0.778630952380953,0.648288690476193,0.513779761904765,0.433839285714287,0.351830357142857,0.266101190476189,0.212946428571426,0.134062499999997,0.0431101190476131,-0.114107142857145,-0.303556547619049,-0.444776785714287,-0.563675595238095,-0.660565476190477,-0.746175595238096,-0.802410714285717,-0.866532738095240,-0.895074404761907,-0.877842261904764,-0.842723214285716,-0.781979166666666,-0.709776785714288,-0.675446428571433,-0.637544642857147,-0.626026785714291,-0.602172619047627,-0.569315476190484,-0.562276785714289,-0.544895833333337,-0.463110119047622,-0.310803571428572,-0.128794642857143,-0.0126934523809563,0.0452232142857110,0.0879017857142816,0.144508928571424,0.206770833333330,0.283645833333333,0.338839285714283,0.373065476190474,0.413318452380953,0.457708333333335,0.483690476190478,0.489315476190479,0.478794642857142,0.486428571428572,0.479776785714288,0.461473214285714,0.455744047619048,0.434479166666669,0.384151785714288,0.299107142857146,0.186458333333334,0.0976041666666703,0.0523511904761929,0.0714732142857173,0.0823958333333348,0.100818452380954,0.118660714285717,0.150208333333337,0.201324404761909,0.232470238095241,0.243125000000003,0.289925595238097,0.361175595238098,0.409940476190478,0.420386904761905,0.426979166666669,0.430297619047620,0.432321428571429,0.430029761904763,0.423184523809523,0.436502976190475,0.421458333333334,0.444300595238095,0.463958333333334,0.443363095238096,0.404330357142859,0.362306547619049,0.320252976190478,0.271279761904761,0.202410714285714,0.122619047619047,0.0778422619047614,0.0111904761904764,-0.0680654761904762,-0.136815476190474,-0.174583333333333,-0.203898809523809,-0.236607142857144,-0.252752976190479,-0.276428571428577,-0.283005952380954,-0.311726190476191,-0.317886904761906,-0.343779761904763,-0.387440476190479,-0.414017857142859,-0.422886904761908,-0.412336309523813,-0.405074404761907,-0.380595238095239,-0.328526785714287,-0.253720238095241,-0.191145833333334,-0.115907738095242,-0.0312797619047664,0.0398065476190439,0.104895833333329,0.164196428571424,0.226443452380950,0.271860119047618,0.312678571428570,0.355684523809520,0.382544642857143,0.403764880952380,0.419925595238093,0.443318452380952,0.463601190476188,0.483645833333332,0.490937499999998,0.495520833333332,0.487306547619045,0.486235119047620,0.470342261904761,0.448764880952380,0.423988095238096,0.390437500000003,0.369276315789472,0.345416666666667,0.320477941176474,0.287187500000000,0.253229166666666,0.215223214285713,0.172451923076926,0.143437499999999,0.118693181818180]; 
    %  data =[72,71.8000000000000,72.6000000000000,73.2000000000000,74.8000000000000,75.8000000000000,76.4000000000000,75.2000000000000,75.6000000000000,74.8000000000000,76,76.8000000000000,75.4000000000000,75.8000000000000,75.6000000000000,74.4000000000000,75.2000000000000,74.8000000000000,75,76.2000000000000,73.8000000000000,72.4000000000000,72.6000000000000,73.8000000000000,76,76.6000000000000,79,78.4000000000000,77.6000000000000,79.4000000000000,78.8000000000000,79,79.8000000000000,80,84.8000000000000,85.6000000000000,85.2000000000000,87.2000000000000,87,87.6000000000000,88.8000000000000,92.6000000000000,92.6000000000000,85.4000000000000,89.2000000000000,90.4000000000000,87.6000000000000,86.6000000000000,87.4000000000000,89.8000000000000,89,89.6000000000000,90.6000000000000,99.6000000000000,95.8000000000000,92.4000000000000,91,91.4000000000000,92.6000000000000,101.800000000000,104,102.400000000000,105.200000000000,104,104.600000000000,113.200000000000,124.600000000000,137,137.600000000000,139.400000000000,153.400000000000,143.200000000000,140.600000000000,133.600000000000,126.600000000000,129.400000000000,122,120.800000000000,112.200000000000,114,102.600000000000,104.200000000000,107.200000000000,105.800000000000];
     % data=[7.80000000000000,7.95000000000000,8.05000000000000,8.05000000000000,7.93000000000000,7.75000000000000,7.84000000000000,7.77000000000000,7.59000000000000,7.53000000000000,7.87000000000000,8.24000000000000,8.36000000000000,8.41000000000000,8.30000000000000,8.29000000000000,8.12000000000000,8,8.10000000000000,8.13000000000000,8.36000000000000,8.46000000000000,8.54000000000000,8.43000000000000,8.26000000000000,8.36000000000000,8.26000000000000,7.63000000000000,7.63000000000000,7.81000000000000,8.05000000000000,8.25000000000000,8.06000000000000,8.05000000000000,7.85000000000000,7.85000000000000,7.73000000000000,7.64000000000000,7.85000000000000,7.83000000000000,7.78000000000000,8.08000000000000,7.96000000000000,8.11000000000000,8.16000000000000,8.06000000000000,7.96000000000000,8,7.83000000000000,7.86000000000000,7.95000000000000,7.87000000000000,7.29000000000000,7.36000000000000,7.55000000000000,6.94000000000000,7.10000000000000,6.85000000000000,6.86000000000000,6.76000000000000,6.82000000000000,6.52000000000000,6.47000000000000,6.86000000000000,6.61000000000000,6.34000000000000,6.41000000000000,6.38000000000000,5.74000000000000,5.40000000000000,5.22000000000000,5.42000000000000,5.29000000000000,5.43000000000000,5.39000000000000,5.46000000000000,5.37000000000000,5.29000000000000,5.56000000000000,5.76000000000000,5.75000000000000,5.69000000000000,5.88000000000000,5.81000000000000,5.86000000000000,5.30000000000000,5.37000000000000,5.22000000000000,5.32000000000000,5.62000000000000,5.64000000000000,5.70000000000000,5.76000000000000,5.75000000000000,5.68000000000000,5.59000000000000,5.60000000000000,5.71000000000000,5.75000000000000,5.76000000000000,5.83000000000000,5.88000000000000,6.05000000000000,5.99000000000000,5.99000000000000,5.83000000000000,5.88000000000000,5.88000000000000,5.79000000000000,5.94000000000000,6.02000000000000,6.03000000000000,6.22000000000000,6.28000000000000,6.09000000000000,6.06000000000000,6.24000000000000,6.18000000000000,6.33000000000000,6.35000000000000,6.31000000000000,6.17000000000000,6.23000000000000,6.05000000000000,5.94000000000000,5.95000000000000,5.90000000000000,5.92000000000000,5.94000000000000,5.91000000000000,5.92000000000000,6.09000000000000,6.12000000000000,6.19000000000000,6,5.90000000000000,5.87000000000000,6.04000000000000,6.02000000000000,6.09000000000000,6.12000000000000,6.04000000000000,5.95000000000000,5.91000000000000,5.91000000000000,5.90000000000000,5.79000000000000,5.73000000000000,5.73000000000000,5.71000000000000,5.72000000000000,5.90000000000000,5.92000000000000,5.91000000000000,5.91000000000000,5.94000000000000,5.90000000000000,5.91000000000000,5.71000000000000,5.70000000000000,5.83000000000000,5.73000000000000,5.79000000000000,5.86000000000000,5.84000000000000,5.90000000000000,5.88000000000000,5.81000000000000,5.88000000000000,5.90000000000000,6.05000000000000,5.82000000000000,5.80000000000000,6.03000000000000,6.37000000000000,6.32000000000000,6.30000000000000,6.17000000000000,6.17000000000000,6.35000000000000,6.56000000000000,6.45000000000000,6.47000000000000,6.58000000000000,6.50000000000000,6.54000000000000,6.67000000000000,6.55000000000000,6.45000000000000,6.50000000000000,6.44000000000000,6.56000000000000,6.95000000000000,6.83000000000000,7.11000000000000,7.12000000000000,7.24000000000000,7.05000000000000,7.43000000000000,8.02000000000000,7.97000000000000,7.71000000000000,7.78000000000000,8.30000000000000,8.19000000000000,8.27000000000000,8.19000000000000,8.11000000000000,8.05000000000000,8.09000000000000,8.01000000000000,7.93000000000000,8.21000000000000,8.36000000000000,8.30000000000000,8.30000000000000,8.10000000000000,8.14000000000000,8.27000000000000,8.60000000000000,8.81000000000000,8.94000000000000,8.70000000000000,8.49000000000000,8.21000000000000,8.03000000000000,8.20000000000000,8.12000000000000,8.11000000000000,8.24000000000000,8.47000000000000,8.14000000000000,7.94000000000000,7.81000000000000,7.81000000000000,7.91000000000000,8.23000000000000,8.19000000000000,8.41000000000000,8.48000000000000,8.49000000000000,8.23000000000000,8.66000000000000,8.55000000000000,8.46000000000000,8.65000000000000,9,8.89000000000000,8.74000000000000,8.57000000000000,8.45000000000000,8.60000000000000,8.63000000000000,8.35000000000000,8.62000000000000,8.57000000000000,8.76000000000000,8.74000000000000,8.56000000000000,8.67000000000000,8.96000000000000,8.94000000000000,8.81000000000000,8.74000000000000,8.86000000000000,8.86000000000000,8.90000000000000,8.90000000000000,8.90000000000000,9.64000000000000,9.69000000000000,9.84000000000000,9.99000000000000,9.59000000000000,9.65000000000000,9.80000000000000,9.13000000000000,9.01000000000000,9.23000000000000,9.11000000000000,9.25000000000000,8.82000000000000,8.69000000000000,8.53000000000000,8.43000000000000,8.51000000000000,8.47000000000000,8.45000000000000,8.62000000000000,8.67000000000000,8.65000000000000,8.87000000000000,9.10000000000000,9.08000000000000,9.19000000000000,9.19000000000000,9.25000000000000,9.24000000000000,9.12000000000000,9.28000000000000,9.59000000000000,9.50000000000000,9.18000000000000,9.09000000000000,9.14000000000000,9.23000000000000,9.23000000000000,9.47000000000000,9.55000000000000,9.59000000000000,9.81000000000000,9.79000000000000,10,9.91000000000000,9.87000000000000,10.2000000000000,9.99000000000000,10.0800000000000,10.2900000000000,10.8600000000000,10.8700000000000,11.5200000000000,11.2500000000000,11.3200000000000,10.9300000000000,11.1200000000000,11.0200000000000,11.2400000000000,10.9000000000000,10.8100000000000,10.8300000000000,11.0800000000000,11.0100000000000,10.7400000000000,10.6800000000000,10.6800000000000,10.5600000000000,10.6400000000000,10.7100000000000,10.5600000000000,10.9800000000000,11,11.1000000000000,11.2300000000000,11.1200000000000,11.2400000000000,11.7400000000000,12.2200000000000,12.1600000000000,12.1700000000000,11.8800000000000,11.8800000000000,12.0700000000000,11.8600000000000,11.7700000000000,12.1400000000000,12.6700000000000,12.6800000000000,12.8300000000000,12.9100000000000,12.7300000000000,12.7200000000000,12.7200000000000,12.8000000000000,13.0500000000000,12.9200000000000,13.3700000000000,13.1500000000000,11.9600000000000,11.6000000000000,11.7300000000000,12.0400000000000,11.9400000000000,12.2000000000000,12.1900000000000,11.9900000000000,11.6700000000000,10.9700000000000,10.7900000000000,10.5200000000000,10.9100000000000,10.8600000000000,10.2600000000000,10.3800000000000,10.6000000000000,10.5600000000000,10.2700000000000,10.0400000000000,9.70000000000000,9.73000000000000,10.0100000000000,10.1900000000000,10.1700000000000,9.93000000000000,10,10.3700000000000,10.2700000000000,10.5000000000000,10.8700000000000,11.1700000000000,11.1000000000000,11.0900000000000,10.8400000000000,10.8000000000000,10.6700000000000,11.0500000000000,10.9800000000000,11.0600000000000,10.9100000000000,10.9900000000000,11.1100000000000,11.0900000000000,11.0800000000000,11.2200000000000,11.2400000000000,11.3200000000000,10.9100000000000,11.0900000000000,11.2400000000000,11.1100000000000,11.3300000000000,11.1700000000000,10.9700000000000,11.3800000000000,11.3700000000000,11.0500000000000,11.2900000000000,11.8200000000000,11.8300000000000,11.9700000000000,11.9400000000000,11.6500000000000,11.5700000000000,11.3900000000000,11.4200000000000,11.3800000000000,11.5600000000000,10.9400000000000,10.4700000000000,10.5200000000000,10.5500000000000,10.5600000000000,10.3800000000000,10.2700000000000,10.0900000000000,10.4900000000000,10.3900000000000,10.3900000000000,10.5700000000000,10.5500000000000,10.5700000000000,10.4500000000000,10.3200000000000,10.2000000000000,10.5500000000000,10.6600000000000,10.6100000000000,10.6600000000000,10.6300000000000,10.5400000000000,10.5000000000000,10.4400000000000,10.5400000000000,10.3400000000000,10.3300000000000,10.3200000000000,10.2400000000000,10.3400000000000,10.4300000000000,10.8700000000000,11.1100000000000,10.9200000000000,10.8000000000000,10.7800000000000,10.6400000000000,10.5800000000000,10.6300000000000,10.4900000000000,10.3700000000000,10.3800000000000,10.5600000000000,10.4600000000000,10.7400000000000,10.6000000000000,10.6600000000000,10.5400000000000,10.4400000000000,10.4600000000000,10.1500000000000,10.1900000000000,10.0800000000000,10.1900000000000,10.1500000000000,10.3400000000000,10.2200000000000,10.0900000000000,9.83000000000000,9.91000000000000,9.61000000000000,9.32000000000000,9.16000000000000,9.23000000000000,9.26000000000000,9.36000000000000,9.15000000000000,9.07000000000000,9.30000000000000,9.22000000000000,9.17000000000000,9.24000000000000,9.22000000000000,9.43000000000000,9.50000000000000,9.20000000000000,9.22000000000000,9.23000000000000,9.10000000000000,9.12000000000000,9.08000000000000,9.09000000000000,9.03000000000000,9.16000000000000,9.08000000000000,9.03000000000000,9.05000000000000,9.05000000000000,8.98000000000000,8.93000000000000,8.73000000000000,8.47000000000000,8.34000000000000,8.35000000000000,8.16000000000000,8.16000000000000,8.33000000000000,8.23000000000000,8.29000000000000,8.22000000000000,8.17000000000000,8.20000000000000,8.47000000000000,8.53000000000000,8.47000000000000,8.81000000000000,8.83000000000000,8.75000000000000,8.73000000000000,8.70000000000000,8.55000000000000,8.29000000000000,8.43000000000000,8.91000000000000,9.16000000000000,9.20000000000000,9.20000000000000,9.18000000000000,9.22000000000000,9.26000000000000,9.74000000000000,9.80000000000000,9.47000000000000,9.51000000000000,9.10000000000000,9.36000000000000,9.49000000000000,9.40000000000000,9.43000000000000,9.17000000000000,8.35000000000000,8.45000000000000,8.46000000000000,8.39000000000000,8.68000000000000,9.21000000000000,9.33000000000000,9.50000000000000,9.47000000000000,9.33000000000000,9.38000000000000,9.30000000000000,9.57000000000000,9.50000000000000,9.58000000000000,9.47000000000000,9.42000000000000,9.30000000000000,9.11000000000000,9.16000000000000,9.12000000000000,8.99000000000000,8.88000000000000,8.84000000000000,8.75000000000000,8.40000000000000,8.51000000000000,8.56000000000000,8.44000000000000,8.66000000000000,8.77000000000000,8.76000000000000,8.56000000000000,8.46000000000000,8.44000000000000,8.71000000000000,8.63000000000000,8.53000000000000,8.52000000000000,8.36000000000000,8.26000000000000,8.34000000000000,8.31000000000000,8.03000000000000,8.14000000000000,8.43000000000000,8.35000000000000,8.18000000000000,8.25000000000000,7.98000000000000,8.02000000000000,7.94000000000000,8.02000000000000,8.05000000000000,7.97000000000000,8.10000000000000,8.02000000000000,7.95000000000000,8.06000000000000,8,8.02000000000000,8.11000000000000,8.16000000000000,8.13000000000000,8,7.97000000000000,7.96000000000000,7.95000000000000,7.84000000000000,7.66000000000000,7.65000000000000,7.29000000000000,7.36000000000000,7.42000000000000,7.40000000000000,7.36000000000000,7.16000000000000,7.08000000000000,7.11000000000000,7.01000000000000,6.93000000000000,7.24000000000000,7.18000000000000,7.69000000000000,7.60000000000000,7.65000000000000,7.17000000000000,7.10000000000000,7.02000000000000,7.09000000000000,7.21000000000000,7.11000000000000,7,6.74000000000000,6.63000000000000,6.64000000000000,6.77000000000000,6.81000000000000,6.68000000000000,6.85000000000000,6.89000000000000,6.85000000000000,6.71000000000000,6.59000000000000,6.94000000000000,7.13000000000000,7.67000000000000,7.96000000000000,7.83000000000000,7.67000000000000,7.73000000000000,7.97000000000000,7.82000000000000,7.77000000000000,7.80000000000000,7.53000000000000,7.57000000000000,8,7.86000000000000,7.92000000000000,7.85000000000000,7.81000000000000,7.76000000000000,7.66000000000000,7.31000000000000,7.20000000000000,7.20000000000000,7.47000000000000,7.33000000000000,7.30000000000000,7.23000000000000,7.39000000000000,7.33000000000000,7.26000000000000,7.12000000000000,7.09000000000000,6.97000000000000,7.02000000000000,6.92000000000000,6.87000000000000,6.98000000000000,6.90000000000000,6.72000000000000,6.73000000000000,6.89000000000000,6.91000000000000,6.77000000000000,7.31000000000000,7.24000000000000,7.20000000000000,7.35000000000000,7.23000000000000,7.23000000000000,7.23000000000000,7.29000000000000,7.05000000000000,7.01000000000000,7.10000000000000,6.84000000000000,6.93000000000000,6.74000000000000,6.37000000000000,6.36000000000000,6.11000000000000,6.19000000000000,6.44000000000000,6.20000000000000,6.23000000000000,6.13000000000000,6.27000000000000,6.21000000000000,6.26000000000000,6.41000000000000,6.48000000000000,6.60000000000000,6.60000000000000,6.53000000000000,6.53000000000000,6.44000000000000,6.33000000000000,6.51000000000000,6.60000000000000,6.67000000000000,6.71000000000000,6.74000000000000,6.79000000000000,6.62000000000000,6.75000000000000,6.58000000000000,6.49000000000000,6.57000000000000,6.43000000000000,6.48000000000000,6.41000000000000,6.41000000000000,6.55000000000000,6.66000000000000,6.68000000000000,6.55000000000000,6.84000000000000,6.85000000000000,6.78000000000000,6.78000000000000,7,6.83000000000000,6.84000000000000,6.55000000000000,6.47000000000000,6.38000000000000,6.34000000000000,6.33000000000000,6.18000000000000,6.29000000000000,6.26000000000000,6.32000000000000,6.30000000000000,6.26000000000000,6.38000000000000,6.47000000000000,6.47000000000000,6.44000000000000,6.38000000000000,6.43000000000000,6.41000000000000,6.47000000000000,6.40000000000000,6.33000000000000,6.43000000000000,6.45000000000000,6.31000000000000,6.27000000000000,6.16000000000000];

         [data_r,data_c]=size(data);
         
         if data_r ~=1 
             error('Invalid argument provided.');  %
         end
         
         output_results=0;
         if data_c < 30   %数据量小于30
             return;
         end
         
%%         
        length_para=ceil( data_c/70 +20-10/7);
        
        data_smoothed = data_smoothing(data);
        [values,locations]=findpeaks(data_smoothed,'minpeakdistance', length_para );
        length_locations=length(locations);
        %%
%         plot(data)
%         hold on
%         plot(data_smoothed);
%         hold on 
%         plot(locations, data_smoothed(locations),'*');
        %%
        
if  length_locations>0 %有极大值

      n=1;  
     for k=1:length_locations  %取消小的极值点,在左右12个点内，不是最大值的就去掉
          
          if locations(k)<=12
              if max(data_smoothed(1:locations(k)+12)) == values(k)
              
                   D(n)=locations(k);
                   C(n)=values(k);
                   n=n+1;
              end
              
          elseif locations(k)>=data_c-12 %389
              
              if max(data_smoothed(locations(k)-12 : data_c)) == values(k)
                   D(n)=locations(k);
                   C(n)=values(k);
                   n=n+1;
              end
          
          else
               if max(data_smoothed(locations(k)-12:locations(k)+12)) == values(k)
                   D(n)=locations(k);
                   C(n)=values(k);
                   n=n+1;
               end
          end
    
      end
  
else   %没有极大值
   return;        
end
    
locations=D;
values= C;
length_locations=length(locations);
%    %%  
%         figure
%         plot(data)
%         hold on
%         plot(data_smoothed);
%         hold on 
%         plot(locations, data_smoothed(locations),'*');

     
%%        
        r=1;
        if length_locations ==0
                return;
        elseif length_locations == 1
            
                min_value(1)= min( data_smoothed( 1: locations(1) ) );
                zx=find(  data_smoothed( 1:locations(1)   ) == min_value(1)  ) ;
                zhibiao_min(r) = zx(1);
                
                min_value(2)= min( data_smoothed( locations(1) : data_c) );
                zx=find(  data_smoothed( locations(1): data_c  ) == min_value(2)  ) ;
                zhibiao_min(r) = locations(1) -1 + zx(1);
        else

                for i=1:length_locations
         
                    if i==1
                          min_value(r)= min( data_smoothed( 1: locations(i) ) );
                          zx= find(  data_smoothed( 1:locations(i)   ) == min_value(r)  ) ;
                          zhibiao_min(r) =zx(1);
                          r=r+1;
                    elseif i==length_locations
                          min_value(r)= min( data_smoothed(  locations(i-1): locations(i) ) );
                          zx=find(  data_smoothed( locations(i-1): locations(i)  ) == min_value(r)  ) ;
                          zhibiao_min(r) = locations(i-1) -1 + zx(1);
                          r=r+1;
                         
                          min_value(r)= min( data_smoothed(  locations(i): data_c ) );
                          zx=find(  data_smoothed( locations(i): data_c    ) == min_value(r)  ) ;
                          zhibiao_min(r) = locations(i) -1 + zx(1);
                          r=r+1;
                    else
                          min_value(r)= min( data_smoothed(  locations(i-1): locations(i) ) );
                          zx=find(  data_smoothed( locations(i-1): locations(i)  ) == min_value(r)  ) ;
                          zhibiao_min(r) = locations(i-1) -1 + zx(1);
                          r=r+1;
                    end


                end
        end
        
   %% 极大值和极小值合并    
   
   output_results=sort([locations,zhibiao_min]);
   
   output_results(find(output_results<=11))=[];
   output_results(find(output_results>=data_c-11))=[];

%    if (output_results(1)-1) <10
%         output_results(1)=[];
%    end
%    if (data_c-output_results(end)) <10
%         output_results(end)=[];
%    end

   
   
%        %
%          plot(data);
%          hold on
%          plot(data_smoothed);
%          hold on 
%          plot( output_results,data( output_results),'*');
end